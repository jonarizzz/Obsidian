**Пространственный индекс (Spatial Index)** — это специализированный индекс в [[База данных (Database)||базах данных]], который используется для оптимизации запросов, связанных с пространственными (географическими или геометрическими) данными. Такие данные могут включать в себя координаты, точки, линии, полигоны и другие геометрические объекты.

Пространственные индексы особенно полезны для обработки запросов, связанных с географическими системами (например, в GIS) или приложений, работающих с картами, маршрутизацией и анализом пространственных данных.

### Основные характеристики:

- Работа с геометрическими объектами – поддерживает такие типы данных, как точки (Point), линии (LineString), полигоны (Polygon), мультиполигоны (MultiPolygon) и их комбинации.
- Оптимизация запросов – ускоряет операции, связанные с геометрическими расчетами: поиск объектов внутри заданной области, пересечение геометрий, ближайшие соседи и т.д.
- Поддержка стандартов – пространственные индексы реализуют спецификации стандарта OGC (Open Geospatial Consortium) для работы с географическими данными.

### Типы пространственных индексов:

- R-Tree (Rectangle Tree):
	- Один из самых популярных типов индекса для пространственных данных.
	- Делит пространство на минимальные ограничивающие прямоугольники (MBR — Minimum Bounding Rectangle).
	- Хорошо подходит для поиска объектов в области и пересечений.
- Quadtree:
	- Делит пространство на 4 квадранта и продолжает деление рекурсивно.
	- Используется для двумерных данных (карты, изображения).
- Geohash:
	- Основан на делении пространства на сетку и представлении ее ячеек в виде хешей.
	- Применяется для упрощения географического поиска.
- Grid Index (Сеточный индекс):
	- Простое деление пространства на сетку.
	- Хорошо работает для данных, равномерно распределенных по пространству.
- KD-Tree:
	- Дерево, ориентированное на деление пространства по осям координат (x, y, z и т.д.).
	- Подходит для поиска ближайших соседей.

### Поддержка в СУБД:

PostgreSQL (с расширением PostGIS): Реализует GIST-индексы для пространственных данных.
```sql
CREATE INDEX idx_geography ON my_table USING GIST(geog_column);
```
  
MySQL: Поддерживает тип данных SPATIAL и индексы для геометрии.
```sql
CREATE SPATIAL INDEX idx_spatial ON my_table (geom_column);
```
  
Oracle:
- Пространственные индексы реализованы через Oracle Spatial.
- Поддерживает R-Tree индексы.

Microsoft SQL Server: Поддерживает тип данных GEOGRAPHY и GEOMETRY с индексами.

MongoDB: Поддерживает пространственные индексы для работы с геообъектами (GeoJSON).


### Пример использования:

Запрос на поиск объектов внутри области:
```sql
SELECT * 
FROM places 
WHERE ST_Contains(geom, ST_GeomFromText('POLYGON((...))'));
```

Поиск ближайших объектов:
```sql
SELECT * 
FROM places 
ORDER BY ST_Distance(geom, ST_Point(12.34, 56.78)) 
LIMIT 5;
```

### Преимущества:

- Значительно ускоряют выполнение пространственных запросов.
- Уменьшают нагрузку на процессор при обработке больших объемов данных.
- Позволяют выполнять сложные геометрические операции (пересечения, объединения, расстояния).

### Ограничения:

- Создание и поддержка пространственного индекса могут занимать больше времени и ресурсов.
- Не всегда эффективно для сильно неоднородных данных.
- В разных СУБД могут быть разные ограничения на типы поддерживаемых индексов и операций.