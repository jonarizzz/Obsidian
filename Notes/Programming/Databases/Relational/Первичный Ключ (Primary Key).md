Первичный ключ (primary key) — это уникальный идентификатор записи в таблице базы данных. Он служит для однозначного определения каждой строки в [[Таблица БД (DB Table)||таблице]] и является одним из основных элементов, обеспечивающих целостность данных. Вот основные аспекты первичных ключей:

### Основные характеристики:

1. Уникальность – значение первичного ключа должно быть уникальным для каждой строки. Это предотвращает появление дублирующихся записей.
2. Не может быть NULL – поле, определённое как первичный ключ, обязательно должно содержать значение. Пустые (NULL) значения недопустимы.
3. Одна таблица = один первичный ключ – в каждой таблице может быть только один первичный ключ, но он может состоять из одного или нескольких столбцов (см. составные ключи).
4. Иммутабельность – значения первичного ключа, как правило, не должны изменяться после создания записи, так как это может повлиять на связь с другими таблицами.

### Создание первичного ключа:

5. При создании таблицы:
	В SQL первичный ключ задаётся при создании таблицы:
```sql
CREATE TABLE users (
    id INT PRIMARY KEY,      -- Одиночный первичный ключ
    username VARCHAR(255)
);
```

6. Составной (комбинированный) ключ:
	Если уникальность должна быть основана на комбинации нескольких столбцов:
```sql
CREATE TABLE orders (
    order_id INT,
    product_id INT,
    PRIMARY KEY (order_id, product_id)  -- Составной ключ
);
```

7. Добавление ключа к существующей таблице:
```sql
ALTER TABLE users
ADD PRIMARY KEY (id);
```

### Составные ключи

Составной первичный ключ состоит из нескольких столбцов, уникальность которых гарантируется только в комбинации. Например, таблица для хранения заказов может использовать `order_id` и `product_id` как составной ключ.

### Автоматическая генерация ключей

Для автоматической генерации уникальных значений можно использовать автоинкремент:

``` sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(255)
);
```


### Использование первичных ключей для связей

Первичные ключи часто используются в связях между таблицами, например, при создании внешнего ключа:

``` sql
CREATE TABLE orders (
    order_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### Преимущества:

- Обеспечение целостности данных – уникальные и не NULL значения предотвращают дублирование и ошибки в данных.
- Быстрая идентификация записей – [[Индекс (Index)||индекс]], который создаётся на поле первичного ключа, ускоряет поиск записей.
- Упрощение работы с внешними ключами – первичный ключ служит основой для построения связей между таблицами.

### Рекомендации по выбору первичного ключа:

- Используйте числовые значения (например, INT, BIGINT) — они быстрее обрабатываются индексами.
- Выбирайте поле, которое вряд ли изменится (например, не используйте номера телефонов или email-адреса, так как они могут измениться).
- Если подходящего поля нет, используйте суррогатные ключи — автоматически генерируемые идентификаторы, такие как UUID или AUTO_INCREMENT.

### Типичные ошибки и их последствия:

- Использование изменяемых полей – например, если ключ изменится, это может нарушить связи с другими таблицами.
- Дублирование данных – если первичный ключ не настроен, данные могут дублироваться, что затруднит обработку.
- Отсутствие первичного ключа – в этом случае сложно обеспечить целостность данных и организовать связи между таблицами.

  
