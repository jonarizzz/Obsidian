`EXPLAIN` в PostgreSQL используется для получения информации о том, как PostgreSQL планирует выполнить запрос. Это помогает анализировать и оптимизировать SQL-запросы, показывая, какие [[Индекс (Index)||индексы]] будут использоваться, какие операции будут выполняться и в каком порядке. Когда вы используете `EXPLAIN`, PostgreSQL генерирует план выполнения, который можно анализировать для понимания его производительности.

### Основные варианты использования:

- Простой EXPLAIN:
	- Просто перед запросом можно использовать EXPLAIN, чтобы увидеть план выполнения.
	- Пример:
```sql
EXPLAIN SELECT * FROM employees WHERE department_id = 3;
```

- EXPLAIN ANALYZE:
	- Этот вариант не только показывает план выполнения, но и фактически выполняет запрос, чтобы замерить его реальное время выполнения, количество строк и другие параметры. Это полезно для диагностики производительности.
	- Пример:
```sql
EXPLAIN ANALYZE SELECT * FROM employees WHERE department_id = 3;
```

  - EXPLAIN (FORMAT JSON):
	  - Вы можете запросить вывод в формате JSON, что полезно для дальнейшего анализа или обработки.
	  - Пример:
```
EXPLAIN (FORMAT JSON) SELECT * FROM employees WHERE department_id = 3;
```


### Важные элементы плана выполнения:

- **Seq Scan** — последовательное сканирование таблицы. Это обычно происходит, когда PostgreSQL не может использовать индекс.
- **Index Scan** — использование индекса для поиска данных.
- **Bitmap Heap Scan** — когда PostgreSQL сначала строит [[Индекс на основе битовой карты (Bitmap Index)||битовую карту]] для поиска строк и затем считывает их из таблицы.
- **Join Types** — различные способы соединения таблиц (например, Nested Loop, Hash Join, Merge Join).

### Дополнительные параметры:

Вы можете запросить дополнительную информацию, такую как BUFFERS, чтобы увидеть, сколько данных было прочитано из буфера.

Пример:
```sql
EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM employees WHERE department_id = 3;
```