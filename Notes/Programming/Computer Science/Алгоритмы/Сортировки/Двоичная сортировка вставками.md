Двоичная сортировка вставками — это улучшение обычной сортировки вставками. Она использует **бинарный поиск**, чтобы найти правильное место для вставки элемента, что уменьшает количество сравнений. Однако сдвиги элементов всё равно остаются, поэтому время выполнения всё ещё $O(n^2)$ в худшем случае.

1. **Разделение массива**: Считаем, что первый элемент уже отсортирован. Начинаем со второго элемента.
2. **Поиск позиции для вставки**: Для каждого нового элемента выполняем бинарный поиск в отсортированной части массива, чтобы найти его позицию.
3. **Сдвиг элементов**: Все элементы, которые больше текущего, сдвигаются на одну позицию вправо, чтобы освободить место для вставки.
4. **Вставка**: Вставляем текущий элемент на найденную позицию.


![[Двоичная сортировка вставками.gif]]

**Имплементация:**

```
import java.util.Arrays;

public class BinaryInsertionSort {

    // Метод для бинарного поиска позиции вставки
    private static int binarySearch(int[] array, int key, int start, int end) {
        while (start < end) {
            int mid = start + (end - start) / 2;
			
            if (key < array[mid]) {
                end = mid;
            } else {
                start = mid + 1;
            }
        }
        return start;
    }
	
    // Метод двоичной сортировки вставками
    public static void binaryInsertionSort(int[] array) {
        int n = array.length;
		
        for (int i = 1; i < n; i++) {
            int key = array[i];
            // Найти позицию для вставки текущего элемента
            int pos = binarySearch(array, key, 0, i);
			
            // Сдвинуть элементы вправо
            for (int j = i; j > pos; j--) {
                array[j] = array[j - 1];
            }
			
            // Вставить элемент на найденную позицию
            array[pos] = key;
        }
    }

    public static void main(String[] args) {
        int[] array = {10, 3, 7, 4, 12};
        System.out.println("Before sorting: " + Arrays.toString(array));
		
        binaryInsertionSort(array);
        System.out.println("After sorting: " + Arrays.toString(array));
    }
}
```


**Сложность:**

1. **Бинарный поиск**: Выполняется за $O(\log n)$ сравнений для каждого элемента.
2. **Сдвиг элементов**: В худшем случае может потребоваться $O(n)$ сдвигов для одного элемента.
3. **Итоговая сложность**: $O(n \log n + n^2) = O(n^2)$

Несмотря на использование бинарного поиска, сложность остаётся квадратичной из-за сдвигов.

**Пространственная сложность**
Двоичная сортировка вставками не требует дополнительной памяти: $O(1)$